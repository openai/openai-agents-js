---
title: Twilio와 실시간 에이전트 사용
description: Connect your Agents SDK agents to Twilio to use voice agents
---

import { Aside, Steps, Code } from '@astrojs/starlight/components';
import twilioBasicExample from '../../../../../../examples/docs/extensions/twilio-basic.ts?raw';
import twilioServerExample from '../../../../../../examples/realtime-twilio/index.ts?raw';

Twilio는 전화 통화의 원문 오디오를 WebSocket 서버로 전송하는 [Media Streams API](https://www.twilio.com/docs/voice/media-streams)를 제공합니다. 이 설정은 여러분의 [Overview](/openai-agents-js/ko/guides/voice-agents)를 Twilio에 연결하는 데 사용할 수 있습니다. Twilio에서 오는 이벤트를 Realtime Session에 연결하기 위해 기본 Realtime Session 트랜스포트를 `websocket` 모드로 사용할 수 있습니다. 그러나, 전화 통화는 웹 기반 대화보다 자연스럽게 지연이 더 크므로, 올바른 오디오 포맷을 설정하고 자체 인터럽션(중단 처리) 타이밍을 조정해야 합니다.

설정 경험을 개선하기 위해, 인터럽션(중단 처리)과 오디오 포워딩을 포함해 Twilio와의 연결을 대신 처리하는 전용 전송 계층을 만들었습니다.

<Aside type="caution">
  이 어댑터는 아직 베타 단계입니다. 드문 엣지 케이스나 버그를 겪을 수 있습니다.
  문제를 발견하시면 [GitHub
  issues](https://github.com/openai/openai-agents-js/issues)를 통해 보고해
  주세요. 빠르게 수정하겠습니다.
</Aside>

## 설정

<Steps>

1. **Twilio 계정과 Twilio 전화번호가 있는지 확인하세요.**

2. **Twilio에서 오는 이벤트를 받을 수 있는 WebSocket 서버를 설정하세요.**

   로컬에서 개발 중이라면, 이는 여러분이 다음과 같은 로컬 터널을 구성해야 함을 의미합니다. 이는 여러분이 다음과 같은 로컬 터널을 구성해야 함을 의미합니다: [`ngrok`](https://ngrok.io/) 또는
   [Cloudflare Tunnel](https://developers.cloudflare.com/pages/how-to/preview-with-cloudflare-tunnel/)
   을 사용해 로컬 서버에 Twilio가 접근할 수 있도록 해야 합니다. `TwilioRealtimeTransportLayer`를
   사용해 Twilio에 연결할 수 있습니다.

3. **extensions 패키지를 설치하여 Twilio 어댑터를 설치하세요:**

   ```bash
   npm install @openai/agents-extensions
   ```

4. **`RealtimeSession`에 연결하기 위해 어댑터와 모델을 임포트하세요:**

   <Code
     lang="typescript"
     code={twilioBasicExample.replace(
       /\n\s+\/\/ @ts-expect-error - this is not defined/g,
       '',
     )}
   />

5. **`RealtimeSession`을 Twilio에 연결하세요:**

   ```typescript
   session.connect({ apiKey: 'your-openai-api-key' });
   ```

</Steps>

`RealtimeSession`에서 기대되는 모든 이벤트와 동작(도구 호출, 가드레일 등)이 그대로 작동합니다. `RealtimeSession`을 음성 에이전트와 함께 사용하는 방법에 대한 자세한 내용은 [Overview](/openai-agents-js/ko/guides/voice-agents)를 참고하세요.

## 팁과 고려사항

1. **속도가 핵심입니다.**

   Twilio에서 필요한 모든 이벤트와 오디오를 받으려면, WebSocket 연결에 대한 참조를 얻는 즉시
   `TwilioRealtimeTransportLayer` 인스턴스를 생성하고 바로 이어서 `session.connect()`를 호출하세요.

2. **Twilio 원문 이벤트에 접근하세요.**

   Twilio가 전송하는 원문 이벤트에 접근하려면, `RealtimeSession` 인스턴스에서 `transport_event`
   이벤트를 구독하면 됩니다. Twilio에서 오는 모든 이벤트는 타입이 `twilio_message`이며,
   원문 이벤트 데이터가 담긴 `message` 프로퍼티를 포함합니다.

3. **디버그 로그를 확인하세요.**

   문제 상황에서 더 많은 정보가 필요할 때가 있습니다. `DEBUG=openai-agents*` 환경 변수를 사용하면
   Agents SDK의 모든 디버그 로그가 출력됩니다. 또는 `DEBUG=openai-agents:extensions:twilio*`를
   사용해 Twilio 어댑터에 대한 디버그 로그만 활성화할 수 있습니다.

## 전체 예제 서버

아래는 Twilio로부터 요청을 수신하고 이를 `RealtimeSession`으로 전달하는, 엔드투엔드 WebSocket 서버의 예제입니다.

<Code
  lang="typescript"
  code={twilioServerExample}
  title="Example server using Fastify"
/>
