---
title: ツール
description: Provide your agents with capabilities via hosted tools or custom function tools
---

import { Code } from '@astrojs/starlight/components';
import toolsFunctionExample from '../../../../../../examples/docs/tools/functionTools.ts?raw';
import toolsHostedToolsExample from '../../../../../../examples/docs/tools/hostedTools.ts?raw';
import nonStrictSchemaTools from '../../../../../../examples/docs/tools/nonStrictSchemaTools.ts?raw';
import agentsAsToolsExample from '../../../../../../examples/docs/tools/agentsAsTools.ts?raw';
import agentsAsToolsStreamingExample from '../../../../../../examples/docs/tools/agentsAsToolsStreaming.ts?raw';
import mcpLocalServer from '../../../../../../examples/docs/tools/mcpLocalServer.ts?raw';

ツールはエージェントが**行動を実行する**ための手段です。データ取得、外部 API 呼び出し、コード実行、さらにはコンピュータの操作まで可能です。JavaScript/TypeScript SDK は次の 4 つのカテゴリーをサポートします。

1. **組み込みツール（Hosted）** – モデルと同じ OpenAI サーバー上で実行します。_(Web 検索、ファイル検索、コンピュータ操作、Code Interpreter、画像生成)_
2. **関数ツール** – 任意のローカル関数を JSON Schema でラップして LLM から呼び出せるようにします
3. **エージェントをツールとして** – エージェント全体を呼び出し可能なツールとして公開します
4. **ローカル MCP サーバー** – お使いのマシン上で動作する Model Context Protocol サーバーを接続します

---

## 1. 組み込みツール（Hosted）

`OpenAIResponsesModel` を使用する場合、次の組み込みツールを追加できます:

| ツール              | Type string          | 目的                                    |
| ------------------- | -------------------- | --------------------------------------- |
| Web 検索            | `'web_search'`       | インターネット検索                      |
| ファイル / 取得検索 | `'file_search'`      | OpenAI がホストするベクトルストアの検索 |
| コンピュータ操作    | `'computer'`         | GUI 操作を自動化                        |
| Shell               | `'shell'`            | ホスト上でシェルコマンドを実行          |
| Apply patch         | `'apply_patch'`      | V4A diff をローカルファイルに適用       |
| Code Interpreter    | `'code_interpreter'` | サンドボックス環境でコードを実行        |
| 画像生成            | `'image_generation'` | テキストから画像を生成                  |

<Code lang="typescript" code={toolsHostedToolsExample} title="Hosted tools" />

正確なパラメーター群は OpenAI Responses API と一致します。`rankingOptions` やセマンティックフィルタなどの高度なオプションは公式ドキュメントを参照してください。

---

## 2. 関数ツール

`tool()` ヘルパーで**任意の**関数をツール化できます。

<Code
  lang="typescript"
  code={toolsFunctionExample}
  title="Function tool with Zod parameters"
/>

### オプションリファレンス

| フィールド      | 必須   | 説明                                                                                                                                       |
| --------------- | ------ | ------------------------------------------------------------------------------------------------------------------------------------------ |
| `name`          | いいえ | 省略時は関数名（例: `get_weather`）が使用されます                                                                                          |
| `description`   | はい   | LLM に表示される、明確で人間が読める説明                                                                                                   |
| `parameters`    | はい   | Zod スキーマ、または元の JSON Schema オブジェクトのいずれか。Zod の parameters を使うと自動的に **strict** モードが有効になります          |
| `strict`        | いいえ | `true`（デフォルト）の場合、引数が検証に通らなければ SDK はモデルエラーを返します。あいまいなマッチングを許可するには `false` に設定します |
| `execute`       | はい   | `(args, context) => string \| Promise<string>` – ビジネスロジック。2 番目の省略可能なパラメーターは `RunContext` です                      |
| `errorFunction` | いいえ | 内部エラーをユーザー向けの文字列に変換するカスタムハンドラー `(context, error) => string`                                                  |

### 非 strict な JSON‑schema ツール

無効または不完全な入力をモデルに推測させたい場合は、元の JSON Schema を使用する際に strict モードを無効化できます:

<Code
  lang="typescript"
  code={nonStrictSchemaTools}
  title="Non-strict JSON schema tools"
/>

---

## 3. エージェントをツールとして

会話全体を完全にハンドオフせず、あるエージェントが別のエージェントを支援したい場合があります。`agent.asTool()` を使用します:

<Code lang="typescript" code={agentsAsToolsExample} title="Agents as tools" />

内部的には SDK は以下を行います:

- 単一の `input` パラメーターを持つ関数ツールを作成
- ツールが呼び出されたときに、その入力でサブエージェントを実行
- `customOutputExtractor` で抽出した出力、または最後のメッセージを返却

エージェントをツールとして実行する場合、Agents SDK はデフォルト設定で Runner を作成し、関数実行の中でその Runner でエージェントを実行します。`runConfig` や `runOptions` のプロパティを渡したい場合は、`asTool()` メソッドに渡して Runner の動作をカスタマイズできます。

### エージェントツールからのストリーミングイベント

エージェントツールはネストされたすべての実行イベントをアプリへストリーミングできます。ツールの構築方法に合うフックスタイルを選んでください:

<Code
  lang="typescript"
  code={agentsAsToolsStreamingExample}
  title="Streaming agent tools"
/>

- イベントタイプは `RunStreamEvent['type']` に一致: `raw_model_stream_event`, `run_item_stream_event`, `agent_updated_stream_event`
- `onStream` は最もシンプルな「キャッチオール」で、ツールをインラインで宣言する場合（`tools: [agent.asTool({ onStream })]`）に適しています。イベントごとの振り分けが不要な場合に使用してください
- `on(eventName, handler)` は選択的（または `'*'`）に購読でき、より細かい処理が必要な場合や作成後にリスナーを追加したい場合に最適です
- `onStream` または任意の `on(...)` ハンドラーを提供した場合、エージェントツールは自動的にストリーミングモードで実行されます。提供しない場合は非ストリーミングの経路になります
- ハンドラーは並行に呼び出されるため、遅い `onStream` コールバックが `on(...)` ハンドラーをブロックすることはありません（その逆も同様）
- モデルのツール呼び出し経由でツールが起動された場合は `toolCallId` が付与されます。直接の `invoke()` 呼び出しやプロバイダー固有の挙動では省略されることがあります

---

## 4. MCP サーバー

[Model Context Protocol (MCP)](https://modelcontextprotocol.io/) サーバー経由でツールを公開し、エージェントに接続できます。たとえば `MCPServerStdio` を使って stdio MCP サーバーを起動・接続できます:

<Code lang="typescript" code={mcpLocalServer} title="Local MCP server" />

完全な例については [`filesystem-example.ts`](https://github.com/openai/openai-agents-js/tree/main/examples/mcp/filesystem-example.ts) を参照してください。また、MCP サーバーツール統合の包括的なガイドをお探しの場合は、[MCP 連携](/openai-agents-js/ja/guides/mcp) を参照してください。

---

## ツール使用時の動作

モデルがいつ・どのようにツールを使用すべきか（`tool_choice`、`toolUseBehavior` など）の制御については、[エージェント](/openai-agents-js/ja/guides/agents#forcing-tool-use) を参照してください。

---

## ベストプラクティス

- **短く明確な説明** – ツールが何をするのか、そしていつ使うのかを説明する
- **入力の検証** – 可能な限り Zod スキーマで厳密な JSON 検証を行う
- **エラーハンドラーで副作用を避ける** – `errorFunction` は有用な文字列を返すべきで、例外は投げない
- **ツールごとに単一責務** – 小さく合成可能なツールはより良いモデル推論につながる

---

## 次のステップ

- [ツール使用の強制](/openai-agents-js/ja/guides/agents#forcing-tool-use) について学ぶ
- ツールの入力や出力を検証するために [ガードレール](/openai-agents-js/ja/guides/guardrails) を追加する
- [`tool()`](/openai-agents-js/openai/agents/functions/tool) と各種組み込みツールタイプの TypeDoc リファレンスを読む
