---
title: エージェント
description: Learn more about how to define agents in the OpenAI Agents SDK for JavaScript / TypeScript
---

import { Code } from '@astrojs/starlight/components';
import simpleAgent from '../../../../../../examples/docs/agents/simpleAgent.ts?raw';
import agentWithTools from '../../../../../../examples/docs/agents/agentWithTools.ts?raw';
import agentWithContext from '../../../../../../examples/docs/agents/agentWithContext.ts?raw';
import agentWithAodOutputType from '../../../../../../examples/docs/agents/agentWithAodOutputType.ts?raw';
import agentWithHandoffs from '../../../../../../examples/docs/agents/agentWithHandoffs.ts?raw';
import agentWithDynamicInstructions from '../../../../../../examples/docs/agents/agentWithDynamicInstructions.ts?raw';
import agentWithLifecycleHooks from '../../../../../../examples/docs/agents/agentWithLifecycleHooks.ts?raw';
import agentCloning from '../../../../../../examples/docs/agents/agentCloning.ts?raw';
import agentForcingToolUse from '../../../../../../examples/docs/agents/agentForcingToolUse.ts?raw';

エージェント は OpenAI Agents SDK の主要な基本コンポーネントです。 ** エージェント ** は、次の内容で構成された Large Language Model (LLM) です:

- ** Instructions ** – モデルに _誰であるか_、_どのように応答すべきか_ を伝える システムプロンプト
- ** Model ** – どの OpenAI モデルを呼び出すか、および任意のモデル チューニング パラメーター
- ** Tools ** – タスクを達成するために LLM が呼び出せる関数や API の一覧

<Code lang="typescript" code={simpleAgent} title="基本のエージェント定義" />

このページの残りでは、エージェント のすべての機能を詳しく説明します。

---

## 基本設定

`Agent` コンストラクターは単一の設定オブジェクトを受け取ります。最もよく使われるプロパティは次のとおりです。

| プロパティ      | 必須 | 説明                                                                                               |
| --------------- | ---- | -------------------------------------------------------------------------------------------------- |
| `name`          | yes  | 短い人間可読の識別子                                                                               |
| `instructions`  | yes  | システムプロンプト（文字列 ** または ** 関数 – [動的 instructions](#dynamic-instructions) を参照） |
| `model`         | no   | モデル名 ** または ** カスタムの [Model](/openai-agents-js/openai/agents/interfaces/model/) 実装   |
| `modelSettings` | no   | チューニング パラメーター（temperature、top_p など）                                               |
| `tools`         | no   | モデルが呼び出せる [Tool](/openai-agents-js/openai/agents/type-aliases/tool/) インスタンスの配列   |

<Code
  lang="typescript"
  code={agentWithTools}
  title="ツール付きのエージェント"
/>

---

## コンテキスト

エージェント はコンテキスト型に対してジェネリックです（例: `Agent<TContext, TOutput>`）。この コンテキスト は、あなたが作成して `Runner.run()` に渡す 依存性注入 オブジェクトです。これはすべての ツール、ガードレール、ハンドオフ などに転送され、状態の保存や共有サービス（データベース接続、ユーザー メタデータ、機能フラグ など）の提供に便利です。

<Code
  lang="typescript"
  code={agentWithContext}
  title="コンテキスト付きのエージェント"
/>

---

## 出力タイプ

既定では、エージェント はプレーンテキスト（`string`）を返します。モデルに構造化オブジェクトを返させたい場合は、`outputType` プロパティを指定できます。SDK は次を受け付けます:

1. [Zod](https://github.com/colinhacks/zod) スキーマ（`z.object({...})`）
2. 任意の JSON Schema 互換オブジェクト

<Code
  lang="typescript"
  code={agentWithAodOutputType}
  title="Zod を使った構造化出力"
/>

`outputType` が与えられると、SDK はプレーンテキストの代わりに
[structured outputs](https://platform.openai.com/docs/guides/structured-outputs) を自動的に使用します。

---

## ハンドオフ

エージェント は `handoffs` プロパティ経由で他の エージェント に委譲できます。一般的なパターンとして、会話をより特化したサブエージェントに振り分ける トリアージ エージェント を使います。

<Code
  lang="typescript"
  code={agentWithHandoffs}
  title="ハンドオフ付きのエージェント"
/>

このパターンの詳細は、[ハンドオフ](/openai-agents-js/ja/guides/handoffs) ガイドを参照してください。

---

## 動的 instructions

`instructions` は文字列の代わりに ** 関数 ** にすることもできます。この関数は現在の `RunContext` と Agent インスタンスを受け取り、文字列 _または_ `Promise<string>` を返せます。

<Code
  lang="typescript"
  code={agentWithDynamicInstructions}
  title="動的 instructions を使うエージェント"
/>

同期・`async` の両方の関数をサポートします。

---

## ライフサイクルフック

高度なユースケースでは、イベントをリッスンして エージェント のライフサイクルを観測できます

<Code
  lang="typescript"
  code={agentWithLifecycleHooks}
  title="ライフサイクルフックを持つエージェント"
/>

---

## ガードレール

ガードレール は ユーザー 入力や エージェント 出力の検証や変換を可能にします。`inputGuardrails` と `outputGuardrails` 配列で設定します。詳細は [ガードレール](/openai-agents-js/ja/guides/guardrails) ガイドを参照してください。

---

## エージェントのクローン／コピー

既存の エージェント を少しだけ変更した版が必要ですか？`clone()` メソッドを使うと、まったく新しい Agent インスタンスが返ります。

<Code
  lang="typescript"
  code={agentCloning}
  title="エージェントのクローン作成"
/>

---

## ツール使用の強制

ツールを提供しても、LLM が必ず呼び出すとは限りません。`modelSettings.tool_choice` でツール使用を ** 強制 ** できます:

1. `'auto'`（デフォルト）– ツールを使うかは LLM が判断
2. `'required'` – LLM は必ずツールを呼び出す（どれを使うかは選べる）
3. `'none'` – LLM はツールを呼び出してはならない
4. 特定のツール名（例: `'calculator'`）– LLM はその特定のツールを呼び出さなければならない

<Code lang="typescript" code={agentForcingToolUse} title="ツール使用の強制" />

### 無限ループの防止

ツール呼び出しの後、SDK は `tool_choice` を自動的に `'auto'` にリセットします。これにより、モデルがツール呼び出しを繰り返そうとして無限ループに入ることを防ぎます。この挙動は `resetToolChoice` フラグでオーバーライドするか、`toolUseBehavior` を設定して変更できます:

- `'run_llm_again'`（デフォルト）– ツール結果を使って LLM を再実行
- `'stop_on_first_tool'` – 最初のツール結果を最終回答として扱う
- `{ stopAtToolNames: ['my_tool'] }` – 指定したいずれかのツールが呼ばれた時点で停止
- `(context, toolResults) => ...` – 実行を終了すべきかどうかを返すカスタム関数

```typescript
const agent = new Agent({
  ...,
  toolUseBehavior: 'stop_on_first_tool',
});
```

---

## 次のステップ

- [エージェントの実行](/openai-agents-js/ja/guides/running-agents) を学ぶ
- [ツール](/openai-agents-js/ja/guides/tools)、[ガードレール](/openai-agents-js/ja/guides/guardrails)、[モデル](/openai-agents-js/ja/guides/models) を掘り下げる
- サイドバーの ** @openai/agents ** で TypeDoc リファレンス全体を参照する
