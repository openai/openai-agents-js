---
title: Cloudflare Workers 传输
description: Connect your Agents SDK agents from Cloudflare Workers/workerd using a dedicated transport.
---

import { Aside, Steps, Code } from '@astrojs/starlight/components';
import cloudflareBasicExample from '../../../../../../examples/docs/extensions/cloudflare-basic.ts?raw';

Cloudflare Workers 和其他 workerd 运行时无法使用全局 `WebSocket` 构造函数打开出站 WebSocket。为便于在这些环境中连接 实时智能体，extensions 包提供了一个专用的传输，它在内部通过基于 `fetch()` 的方式完成升级。

<Aside type="caution">
  此适配器仍处于测试阶段。您可能会遇到边缘情况或漏洞。 请通过 [GitHub
  issues](https://github.com/openai/openai-agents-js/issues)
  报告任何问题，我们会尽快修复。对于在 Workers 中使用 Node.js 风格的
  API，可考虑启用 `nodejs_compat`。
</Aside>

## 设置

<Steps>

1. **安装 extensions 包。**

   ```bash
   npm install @openai/agents-extensions
   ```

2. **创建一个传输并将其附加到您的会话。**

   <Code lang="typescript" code={cloudflareBasicExample} />

3. **连接您的 `RealtimeSession`。**

   ```typescript
   await session.connect({ apiKey: 'your-openai-ephemeral-or-server-key' });
   ```

</Steps>

## 注意事项

- Cloudflare 传输在底层使用带有 `Upgrade: websocket` 的 `fetch()`，并且不会等待套接字的 `open` 事件，与 workerd API 一致。
- 使用此传输时，所有 `RealtimeSession` 功能（工具、护栏等）均可照常工作。
- 开发过程中使用 `DEBUG=openai-agents*` 查看详细日志。
