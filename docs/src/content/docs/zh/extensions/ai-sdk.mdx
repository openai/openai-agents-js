---
title: 使用 AI SDK 指定任意模型
description: Connect your Agents SDK agents to any model through the Vercel's AI SDK
---

import { Aside, Steps, Code } from '@astrojs/starlight/components';
import aiSdkSetupExample from '../../../../../../examples/docs/extensions/ai-sdk-setup.ts?raw';

<Aside type="caution">
  该适配器仍处于测试阶段。你在使用某些模型提供方时（尤其是较小的提供方）可能会遇到问题。请通过
  [GitHub issues](https://github.com/openai/openai-agents-js/issues)
  报告问题，我们会尽快修复。
</Aside>

开箱即用，Agents SDK 可通过 Responses API 或 Chat Completions API 使用 OpenAI 模型。不过，如果你想使用其他模型，[Vercel 的 AI SDK](https://sdk.vercel.ai/) 提供了多种受支持的模型，可通过此适配器引入到 Agents SDK 中。

## 设置

<Steps>

1. 通过安装扩展包来安装 AI SDK 适配器：

   ```bash
   npm install @openai/agents-extensions
   ```

2. 从 [Vercel 的 AI SDK](https://ai-sdk.dev/docs/foundations/providers-and-models) 选择所需的模型包并安装：

   ```bash
   npm install @ai-sdk/openai
   ```

3. 导入适配器和模型以连接到你的智能体：

   ```typescript
   import { openai } from '@ai-sdk/openai';
   import { aisdk } from '@openai/agents-extensions/ai-sdk';
   ```

4. 初始化一个供智能体使用的模型实例：

   ```typescript
   const model = aisdk(openai('gpt-5-mini'));
   ```

</Steps>

<Aside type="caution">
  我们支持暴露 `specificationVersion` 为 `v2` 或 `v3` 的 AI SDK 提供方。
  如果你有特定原因需要继续使用较旧的 v1 提供方风格， 你可以从
  [examples/ai-sdk-v1](https://github.com/openai/openai-agents-js/tree/main/examples/ai-sdk-v1)
  复制该模块并将其包含在你的项目中。
</Aside>

## 示例

<Code lang="typescript" code={aiSdkSetupExample} title="AI SDK 设置" />

## 传递提供方元数据

如果需要随消息发送特定于提供方的选项，可通过 `providerMetadata` 传递。该值会直接转发给底层 AI SDK 模型。比如，以下在 Agents SDK 中的 `providerData`

```ts
providerData: {
  anthropic: {
    cacheControl: {
      type: 'ephemeral';
    }
  }
}
```

在使用 AI SDK 集成时会变为

```ts
providerMetadata: {
  anthropic: {
    cacheControl: {
      type: 'ephemeral';
    }
  }
}
```

## AI SDK UI 流式助手

`@openai/agents-extensions/ai-sdk-ui` 提供用于将 Agents SDK 流接入 AI SDK UI 路由的响应助手：

- `createAiSdkTextStreamResponse(source, options?)`：用于纯文本流式响应。
- `createAiSdkUiMessageStreamResponse(source, options?)`：用于 `UIMessageChunk` 流式响应。

这两个助手均接受 `StreamedRunResult`、类流式来源或兼容的包装对象，并返回带有适合流式传输的响应头的 `Response`。

端到端用法请参见本仓库中的 `examples/ai-sdk-ui` 应用。
