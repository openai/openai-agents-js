---
title: 多智能体编排
description: Coordinate the flow between several agents
---

在您的应用中，编排指的是智能体的流程：哪些智能体运行、以什么顺序运行，以及它们如何决定接下来发生什么。主要有两种方式来编排智能体：

1. 允许 LLM 做决策：利用 LLM 的智能进行规划、推理，并据此决定要采取的步骤。
2. 通过代码进行编排：通过您的代码决定智能体的流程。

您可以混合使用这些模式。每种方式都有各自的权衡，详见下文。

## 通过 LLM 的编排

智能体是配备了 instructions、tools 和交接 的 LLM。这意味着对于一个开放式任务，LLM 可以自主规划如何完成任务，使用工具执行操作和获取数据，并通过交接将任务委托给子智能体。比如，一个研究智能体可以配备以下工具：

- Web 搜索：在线查找信息
- 文件搜索与检索：搜索专有数据和连接
- 计算机操作：在计算机上执行操作
- 代码执行：进行数据分析
- 交接：移交给擅长规划、报告撰写等的专业智能体

当任务是开放式且您希望依赖 LLM 的智能时，这种模式非常适合。关键策略包括：

1. 投入精力在优质提示上。明确有哪些工具、如何使用，以及必须遵守的参数范围。
2. 监控并迭代您的应用。找出出错之处，并迭代优化提示。
3. 允许智能体自省与改进。例如在循环中运行，让其自我批判；或提供错误信息让其改进。
4. 使用在某一任务上表现出色的专业智能体，而不是期望一个通用智能体在任何方面都很强。
5. 投入于 [evals](https://platform.openai.com/docs/guides/evals)。这能帮助您训练智能体改进，并在任务上表现更好。

## 通过代码的编排

虽然通过 LLM 的编排很强大，但通过代码进行编排可以让任务在速度、成本和性能方面更加确定和可预测。常见模式包括：

- 使用 [structured outputs](https://platform.openai.com/docs/guides/structured-outputs) 生成可由您的代码检查的格式良好的数据。例如，您可以让智能体将任务分类为几个类别，然后根据该类别选择下一个智能体。
- 串联多个智能体：将一个智能体的输出转换为下一个智能体的输入。比如，把撰写博客的任务拆解为一系列步骤——进行研究、写大纲、写正文、批判性审阅，然后改进。
- 让执行任务的智能体与负责评估并提供反馈的智能体一起在 `while` 循环中运行，直到评估者认为输出符合某些标准。
- 并行运行多个智能体，例如通过 JavaScript 基本组件如 `Promise.all`。当您有多个相互独立的任务时，这有助于提升速度。

我们在[`examples/agent-patterns`](https://github.com/openai/openai-agents-js/tree/main/examples/agent-patterns)中提供了若干代码示例。
