---
title: 多智能体编排
description: Coordinate the flow between several agents
---

编排指的是应用中智能体的流程：哪些智能体运行、以什么顺序运行，以及它们如何决定下一步做什么。主要有两种编排方式：

1. 让 LLM 做决策：利用 LLM 的智能进行规划、推理，并据此决定步骤。
2. 通过代码进行编排：用代码确定智能体的流程。

你可以混合使用这些模式。各自的权衡见下文。

## 通过 LLM 的编排

一个智能体是一个配备了 instructions、tools 和交接 的 LLM。这意味着对于一个开放式任务，LLM 可以自主规划如何完成任务，使用工具执行操作并获取数据，使用交接 将任务委派给子智能体。例如，一个研究型智能体可以配备如下工具：

- Web 搜索以在线查找信息
- 文件搜索与检索以搜索专有数据与连接
- 计算机操作 以在计算机上执行操作
- 代码执行 以进行数据分析
- 交接 给在规划、报告撰写等方面表现出色的专业智能体

当任务是开放式，并且你希望依赖 LLM 的智能时，这种模式非常适合。这里最重要的策略是：

1. 打磨优质的提示。清楚说明可用的工具、如何使用它们，以及必须遵循的参数范围。
2. 监控你的应用并迭代。观察问题出在哪，并迭代优化提示。
3. 允许智能体自省和改进。例如，让它在循环中运行并自我批评；或者提供错误信息并让它改进。
4. 使用擅长单一任务的专业智能体，而不是期望一个通用智能体样样精通。
5. 投入到[evals](https://platform.openai.com/docs/guides/evals)。这让你可以训练智能体改进并更好地完成任务。

## 通过代码的编排

虽然通过 LLM 编排很强大，但通过代码编排在速度、成本和性能方面更具确定性和可预测性。常见模式包括：

- 使用[structured outputs](https://platform.openai.com/docs/guides/structured-outputs)生成可由代码检查的格式良好的数据。例如，你可以让一个智能体将任务分类为若干类别，然后基于该类别选择下一个智能体。
- 将多个智能体串联起来，把一个的输出转换为下一个的输入。你可以把“写博客文章”分解为一系列步骤——做研究、写大纲、写正文、批评与改进。
- 用一个执行任务的智能体与一个评估并提供反馈的智能体在 `while` 循环中运行，直到评估者认为输出满足特定标准为止。
- 并行运行多个智能体，例如通过 JavaScript 基本组件如 `Promise.all`。当你有彼此不依赖的多个任务时，这对速度很有帮助。

我们在[`examples/agent-patterns`](https://github.com/openai/openai-agents-js/tree/main/examples/agent-patterns)中提供了许多代码示例。
