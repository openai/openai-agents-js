---
title: 多智能体编排
description: Coordinate the flow between several agents
---

在应用中，编排指的是智能体的执行流程：哪些智能体运行、以什么顺序运行、以及它们如何决定下一步该做什么。有两种主要的智能体编排方式：

1. 让 LLM 做决策：利用 LLM 的智能进行规划、推理，并据此决定要采取的步骤。
2. 通过代码进行编排：通过代码来确定智能体的流程。

你可以混合使用这些模式。每种方式都有取舍，详见下文。

## 通过 LLM 编排

智能体是配备了 instructions、tools 和交接 的 LLM。这意味着在面对开放式任务时，LLM 可以自主规划如何完成任务，使用工具来执行操作和获取数据，并通过交接把任务委派给子智能体。例如，一个研究类智能体可以配备以下工具：

- Web 搜索用于在线查找信息
- 文件搜索与检索用于在专有数据和连接中检索
- 计算机操作用于在计算机上执行操作
- 代码执行用于进行数据分析
- 交接给在规划、报告撰写等方面擅长的专业智能体

当任务是开放式且你希望依赖 LLM 的智能时，这种模式非常适合。关键做法包括：

1. 投入精力打磨优质提示。明确可用的工具、使用方式，以及必须遵循的参数边界。
2. 监控并迭代你的应用。找出问题点，并迭代调优提示词。
3. 允许智能体自省与改进。例如，循环运行并让其自我批评；或提供错误信息并让其改进。
4. 使用在某一任务上表现卓越的专业智能体，而不是期望一个通用智能体面面俱到。
5. 投入[评测](https://platform.openai.com/docs/guides/evals)。这能让你训练智能体，使其在任务上不断提升。

## 通过代码编排

尽管通过 LLM 编排功能强大，但通过代码进行编排可以在速度、成本和性能方面使任务更加确定和可预测。常见模式包括：

- 使用[structured outputs](https://platform.openai.com/docs/guides/structured-outputs)生成可由代码检查的格式良好的数据。例如，你可以让智能体将任务分类到若干类别中，然后基于该类别选择下一个智能体。
- 将多个智能体串联，把一个智能体的输出转换为下一个的输入。比如，将“撰写博客文章”分解为一系列步骤——先做研究、写大纲、写正文、批判性审阅、再改进。
- 将执行任务的智能体与负责评估和反馈的智能体一起在 `while` 循环中运行，直到评估者认为输出满足某些标准为止。
- 并行运行多个智能体，例如通过 JavaScript 的基础组件 `Promise.all`。当你有多个彼此独立的任务时，这有助于提升速度。

我们在[`examples/agent-patterns`](https://github.com/openai/openai-agents-js/tree/main/examples/agent-patterns)中提供了若干示例。
