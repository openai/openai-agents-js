---
title: 多智能体编排
description: Coordinate the flow between several agents
---

在应用中，编排指的是智能体的运行流程：哪些智能体运行、以什么顺序运行、以及它们如何决定下一步该做什么。编排智能体主要有两种方式：

1. 让 LLM 做决策：利用 LLM 的智能进行规划、推理，并据此决定要采取的步骤。
2. 通过代码进行编排：用你的代码来确定智能体的流程。

你可以将这些模式混合搭配使用。每种方式都有其取舍，详见下文。

## 通过 LLM 进行编排

一个智能体是配备了 instructions、tools 和交接 的 LLM。这意味着，对于一个开放式任务，LLM 可以自主规划如何处理任务，使用工具执行操作并获取数据，并通过交接将任务委派给子智能体。例如，一个研究智能体可以配备如下工具：

- Web 搜索以在线查找信息
- 文件搜索与检索，以在专有数据与连接中检索
- 计算机操作，以在计算机上执行动作
- 代码执行，以进行数据分析
- 交接给擅长规划、报告撰写等工作的专业智能体

当任务是开放式且你希望依赖 LLM 的智能时，这种模式非常适用。这里最重要的策略包括：

1. 打磨高质量的提示词。明确可用的工具、如何使用它们，以及必须遵循的参数范围。
2. 监控应用并持续迭代。观察问题出在哪里，并迭代你的提示词。
3. 允许智能体自省与改进。例如，将其运行在循环中，让它自我批判；或者提供错误信息并让它改进。
4. 采用在某一任务上表现突出的专业智能体，而不是期待一个通用智能体在所有方面都很出色。
5. 投入于 [evals](https://platform.openai.com/docs/guides/evals)。这可以让你训练智能体、持续改进并在任务上表现更好。

## 通过代码进行编排

虽然通过 LLM 编排很强大，但通过代码编排可以让速度、成本和性能更加确定、可预测。常见模式包括：

- 使用 [structured outputs](https://platform.openai.com/docs/guides/structured-outputs) 生成可由你的代码检查的格式良好的数据。例如，你可以让智能体将任务分类到几个类别中，然后基于该类别选择下一个智能体。
- 将多个智能体串联，把一个智能体的输出转化为下一个智能体的输入。你可以把写博客文章这样的任务分解为一系列步骤——做研究、写提纲、撰写正文、批判性审阅，然后改进。
- 使用一个执行任务的智能体与一个负责评估并提供反馈的智能体，在 `while` 循环中运行，直到评估者认为输出符合某些标准。
- 并行运行多个智能体，例如通过 JavaScript 基本组件 `Promise.all`。当你有彼此不依赖的多个任务时，这对速度很有帮助。

我们在 [`examples/agent-patterns`](https://github.com/openai/openai-agents-js/tree/main/examples/agent-patterns) 中提供了若干 code examples。
