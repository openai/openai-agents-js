---
title: 协调多个智能体
description: Coordinate the flow between several agents
---

编排指的是您应用中智能体的流程。哪些智能体运行、以什么顺序运行，以及它们如何决定接下来发生什么？有两种主要方式来编排智能体：

1. 让 LLM 做决策：利用 LLM 的智能进行规划、推理，并据此决定采取哪些步骤。
2. 通过代码进行编排：用您的代码来决定智能体的流程。

您可以混合搭配这些模式。它们各有取舍，详见下文。

## 基于 LLM 的编排

智能体是配备了 instructions、tools 和交接 的 LLM。这意味着面对一个开放式任务时，LLM 可以自主规划如何完成任务，使用 tools 来采取行动和获取数据，并通过交接将任务委派给子智能体。比如，一个研究智能体可以配备如下工具：

- Web 搜索，用于在网上查找信息
- 文件搜索与检索，用于在专有数据和连接中查询
- 计算机操作，用于在计算机上执行动作
- 代码执行，用于进行数据分析
- 交接到专门的智能体，这些智能体擅长规划、报告撰写等

当任务是开放式且您希望依赖 LLM 的智能时，这种模式非常适合。这里最重要的策略是：

1. 打磨高质量的提示。明确哪些 tools 可用、如何使用它们，以及必须遵循哪些参数范围。
2. 监控您的应用并持续迭代。观察问题出现在哪里，并迭代优化提示。
3. 允许智能体自省和改进。例如，将其置于循环中，让它自我批判；或者提供错误信息，让它改进。
4. 让专门化的智能体在单一任务上做到出色，而不是依赖一个通用智能体去胜任一切。
5. 投入到[评测](https://platform.openai.com/docs/guides/evals)。这可以帮助您训练智能体，使其在任务上不断提升。

## 基于代码的编排

尽管基于 LLM 的编排很强大，基于代码的编排在速度、成本和性能方面更具确定性和可预测性。常见模式包括：

- 使用[structured outputs](https://platform.openai.com/docs/guides/structured-outputs)生成您可以用代码检查的格式良好的数据。例如，您可以让一个智能体将任务归类为几个类别，然后根据该类别选择下一个智能体。
- 通过将一个智能体的输出转换为下一个智能体的输入来串联多个智能体。您可以把写一篇博客文章这样的任务分解为一系列步骤：调研、写大纲、撰写正文、批判性审阅，然后改进。
- 让执行任务的智能体与负责评估并提供反馈的智能体在 `while` 循环中协同运行，直到评估者认为输出满足某些标准为止。
- 并行运行多个智能体，例如通过 JavaScript 基本组件如 `Promise.all`。当多个任务彼此独立时，这有助于提升速度。

我们在[`examples/agent-patterns`](https://github.com/openai/openai-agents-js/tree/main/examples/agent-patterns)中提供了许多代码示例。
