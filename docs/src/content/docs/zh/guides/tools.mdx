---
title: 工具
description: Provide your agents with capabilities via hosted tools or custom function tools
---

import { Code } from '@astrojs/starlight/components';
import toolsFunctionExample from '../../../../../../examples/docs/tools/functionTools.ts?raw';
import toolsHostedToolsExample from '../../../../../../examples/docs/tools/hostedTools.ts?raw';
import nonStrictSchemaTools from '../../../../../../examples/docs/tools/nonStrictSchemaTools.ts?raw';
import agentsAsToolsExample from '../../../../../../examples/docs/tools/agentsAsTools.ts?raw';
import mcpLocalServer from '../../../../../../examples/docs/tools/mcpLocalServer.ts?raw';

工具让智能体**采取行动**——获取数据、调用外部 API、执行代码，甚至使用计算机。JavaScript/TypeScript SDK 支持四种类别：

1. **托管工具**——在 OpenAI 服务器上与模型并行运行。_(Web 搜索、文件搜索、计算机操作、Code Interpreter、图像生成)_
2. **函数工具**——使用 JSON 模式包装任意本地函数，使 LLM 可调用。
3. **作为工具的智能体**——将整个智能体暴露为可调用的工具。
4. **本地 MCP 服务器**——附加一个在您机器上运行的 Model Context Protocol 服务器。

---

## 1. 托管工具

使用 `OpenAIResponsesModel` 时，您可以添加以下内置工具：

| 工具                    | 类型字符串           | 用途                             |
| ----------------------- | -------------------- | -------------------------------- |
| Web search              | `'web_search'`       | 互联网搜索。                     |
| File / retrieval search | `'file_search'`      | 查询托管在 OpenAI 上的向量存储。 |
| 计算机操作              | `'computer'`         | 自动化 GUI 交互。                |
| Code Interpreter        | `'code_interpreter'` | 在沙箱环境中运行代码。           |
| 图像生成                | `'image_generation'` | 根据文本生成图像。               |

<Code lang="typescript" code={toolsHostedToolsExample} title="托管工具" />

确切的参数集合与 OpenAI Responses API 保持一致——高级选项如 `rankingOptions` 或语义过滤器，请参阅官方文档。

---

## 2. 函数工具

借助 `tool()` 辅助函数，您可以将**任意**函数变成工具。

<Code
  lang="typescript"
  code={toolsFunctionExample}
  title="带 Zod 参数的函数工具"
/>

### 选项参考

| 字段            | 是否必需 | 说明                                                                                                                                                                                         |
| --------------- | -------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `name`          | 否       | 默认为函数名（例如，`get_weather`）。                                                                                                                                                        |
| `description`   | 是       | 展示给 LLM 的清晰、可读的人类描述。                                                                                                                                                          |
| `parameters`    | 是       | 可以是 Zod 模式，或原始 JSON 模式对象。使用 Zod 参数会自动启用**严格**模式。                                                                                                                 |
| `strict`        | 否       | 当 `true`（默认）时，如果参数未通过校验，SDK 会返回模型错误。将其设为 `false` 可进行模糊匹配。                                                                                               |
| `execute`       | 是       | `(args, context) => string                                                                                               \| Promise<string>`– 您的业务逻辑。可选的第二个参数为`RunContext`。 |
| `errorFunction` | 否       | 自定义处理器 `(context, error) => string`，用于将内部错误转换为用户可见的字符串。                                                                                                            |

### 非严格 JSON 模式工具

如果您需要模型对无效或部分输入进行“猜测”，在使用原始 JSON 模式时可以禁用严格模式：

<Code
  lang="typescript"
  code={nonStrictSchemaTools}
  title="非严格 JSON 模式工具"
/>

---

## 3. 作为工具的智能体

有时您希望某个智能体在不完全进行对话交接的情况下帮助另一个智能体。使用 `agent.asTool()`：

<Code lang="typescript" code={agentsAsToolsExample} title="作为工具的智能体" />

在底层，SDK 会：

- 创建一个仅含 `input` 参数的函数工具。
- 在调用该工具时，使用该输入运行子智能体。
- 返回最后一条消息，或由 `customOutputExtractor` 提取的输出。

---

## 4. 本地 MCP 服务器

您可以通过本地 [Model Context Protocol](https://modelcontextprotocol.io/) 服务器暴露工具，并将其附加到智能体。使用 `MCPServerStdio` 来启动并连接到该服务器：

<Code lang="typescript" code={mcpLocalServer} title="本地 MCP 服务器" />

完整示例参见 [`filesystem-example.ts`](https://github.com/openai/openai-agents-js/tree/main/examples/mcp/filesystem-example.ts)。

---

## 工具使用行为

有关控制模型何时以及如何必须使用工具（`tool_choice`、`toolUseBehavior` 等），请参见[Agents](/openai-agents-js/zh/guides/agents#forcing-tool-use)。

---

## 最佳实践

- **简短且明确的描述**——说明工具做什么以及何时使用。
- **验证输入**——尽可能使用 Zod 模式进行严格的 JSON 校验。
- **避免在错误处理器中产生副作用**——`errorFunction` 应返回有用的字符串，而不是抛出异常。
- **单一职责的工具**——小而可组合的工具有助于模型更好地推理。

---

## 后续步骤

- 了解 [Agents](/openai-agents-js/zh/guides/agents#forcing-tool-use) 中的强制使用工具。
- 添加 [Guardrails](/openai-agents-js/zh/guides/guardrails) 以验证工具的输入或输出。
- 深入查阅 [`tool()`](/openai-agents-js/openai/agents/functions/tool) 以及各种托管工具类型的 TypeDoc 参考。
