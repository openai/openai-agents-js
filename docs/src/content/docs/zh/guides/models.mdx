---
title: 模型
description: Choose and configure language models for your agents
---

import { Code } from '@astrojs/starlight/components';
import modelCustomProviderExample from '../../../../../../examples/docs/models/customProviders.ts?raw';
import setDefaultOpenAIKeyExample from '../../../../../../examples/docs/config/setDefaultOpenAIKey.ts?raw';
import modelSettingsExample from '../../../../../../examples/docs/models/modelSettings.ts?raw';
import promptIdExample from '../../../../../../examples/basic/prompt-id.ts?raw';
import agentWithModelExample from '../../../../../../examples/docs/models/agentWithModel.ts?raw';
import runnerWithModelExample from '../../../../../../examples/docs/models/runnerWithModel.ts?raw';
import gpt5DefaultModelSettingsExample from '../../../../../../examples/docs/models/gpt5DefaultModelSettings.ts?raw';
import setTracingExportApiKeyExample from '../../../../../../examples/docs/config/setTracingExportApiKey.ts?raw';

每个智能体最终都会调用一个 LLM。SDK 通过两个轻量接口对模型进行抽象：

- [`Model`](/openai-agents-js/openai/agents/interfaces/model) – 知道如何针对特定 API 发起一次请求。
- [`ModelProvider`](/openai-agents-js/openai/agents/interfaces/modelprovider) – 将可读的模型**名称**（例如 `'gpt‑5.2'`）解析为 `Model` 实例。

在日常使用中，你通常只需要与模型**名称**交互，偶尔会用到 `ModelSettings`。

<Code
  lang="typescript"
  code={agentWithModelExample}
  title="为每个智能体指定模型"
/>

## 默认模型

当你在初始化 `Agent` 时未指定模型，会使用默认模型。当前默认是出于兼容性和低时延考虑的 [`gpt-4.1`](https://platform.openai.com/docs/models/gpt-4.1)。如果你有权限，建议将智能体设置为 [`gpt-5.2`](https://platform.openai.com/docs/models/gpt-5.2)，以在保留明确 `modelSettings` 的同时获得更高质量。

如果你想切换到其他模型（如 [`gpt-5.2`](https://platform.openai.com/docs/models/gpt-5.2)），有两种方式配置你的智能体。

首先，如果你希望对所有未设置自定义模型的智能体一致地使用某个模型，请在运行智能体之前设置环境变量 `OPENAI_DEFAULT_MODEL`。

```bash
export OPENAI_DEFAULT_MODEL=gpt-5.2
node my-awesome-agent.js
```

其次，你可以为某个 `Runner` 实例设置默认模型。如果未为某个智能体设置模型，将使用该 `Runner` 的默认模型。

<Code
  lang="typescript"
  code={runnerWithModelExample}
  title="为 Runner 设置默认模型"
/>

### GPT-5.x 模型

当你以这种方式使用任意 GPT-5.x 模型（例如 [`gpt-5.2`](https://platform.openai.com/docs/models/gpt-5.2)）时，SDK 会应用默认的 `modelSettings`。这些设置对大多数用例都较为适配。若要调整默认模型的推理强度，请传入你自己的 `modelSettings`：

<Code
  lang="typescript"
  code={gpt5DefaultModelSettingsExample}
  title="自定义 GPT-5 默认设置"
/>

为了更低的时延，推荐在 `gpt-5.2` 上使用 `reasoning.effort: "none"`。gpt-4.1 系列（包括 mini 和 nano 变体）仍然是构建交互式智能体应用的可靠选择。

### 非 GPT-5 模型

如果你传入的是非 GPT-5 的模型名称且未提供自定义 `modelSettings`，SDK 会回退到与任意模型兼容的通用 `modelSettings`。

---

## OpenAI 提供方

默认的 `ModelProvider` 通过 OpenAI API 解析名称。它支持两个不同的端点：

| API              | 用途                                             | 调用 `setOpenAIAPI()`                |
| ---------------- | ------------------------------------------------ | ------------------------------------ |
| Chat Completions | 标准聊天与函数调用                               | `setOpenAIAPI('chat_completions')`   |
| Responses        | 新的以流式为先的生成式 API（工具调用、灵活输出） | `setOpenAIAPI('responses')` _(默认)_ |

### 身份验证

<Code
  lang="typescript"
  code={setDefaultOpenAIKeyExample}
  title="设置默认 OpenAI 密钥"
/>

如果你需要自定义网络设置，也可以通过 `setDefaultOpenAIClient(client)` 插入你自己的 `OpenAI` 客户端。

---

## ModelSettings

`ModelSettings` 与 OpenAI 的参数一一对应，但不依赖具体提供方。

| 字段                   | 类型                                                            | 说明                                                                      |
| ---------------------- | --------------------------------------------------------------- | ------------------------------------------------------------------------- |
| `temperature`          | `number`                                                        | 创造性与确定性之间的权衡。                                                |
| `topP`                 | `number`                                                        | 核采样。                                                                  |
| `frequencyPenalty`     | `number`                                                        | 惩罚重复的 token。                                                        |
| `presencePenalty`      | `number`                                                        | 鼓励新的 token。                                                          |
| `toolChoice`           | `'auto' \| 'required' \| 'none' \| string`                      | 参见[强制使用工具](/openai-agents-js/zh/guides/agents#forcing-tool-use)。 |
| `parallelToolCalls`    | `boolean`                                                       | 在支持的情况下允许并行函数调用。                                          |
| `truncation`           | `'auto' \| 'disabled'`                                          | token 截断策略。                                                          |
| `maxTokens`            | `number`                                                        | 响应中的最大 token 数。                                                   |
| `store`                | `boolean`                                                       | 持久化响应以用于检索/RAG 工作流。                                         |
| `promptCacheRetention` | `'in-memory' \| '24h' \| null`                                  | 在受支持时控制提供方的提示缓存保留策略。                                  |
| `reasoning.effort`     | `'none' \| 'minimal' \| 'low' \| 'medium' \| 'high' \| 'xhigh'` | 适用于 gpt-5.x 模型的推理强度。                                           |
| `reasoning.summary`    | `'auto' \| 'concise' \| 'detailed'`                             | 控制模型返回的推理摘要量。                                                |
| `text.verbosity`       | `'low' \| 'medium' \| 'high'`                                   | 适用于 gpt-5.x 等的文本详尽程度。                                         |
| `providerData`         | `Record<string, any>`                                           | 传递给底层模型的提供方特定透传选项。                                      |

可在不同层级附加设置：

<Code lang="typescript" code={modelSettingsExample} title="模型设置" />

`Runner` 级别的设置会覆盖任意冲突的智能体级别设置。

---

## 提示词

智能体可以通过 `prompt` 参数进行配置，指示使用服务器存储的提示词配置来控制智能体的行为。目前，该选项仅在你使用 OpenAI 的
[Responses API](https://platform.openai.com/docs/api-reference/responses) 时受支持。

| 字段        | 类型     | 说明                                                                                |
| ----------- | -------- | ----------------------------------------------------------------------------------- |
| `promptId`  | `string` | 提示词的唯一标识符。                                                                |
| `version`   | `string` | 你希望使用的提示词版本。                                                            |
| `variables` | `object` | 用于替换到提示词中的键/值变量。取值可以是字符串或如文本、图像、文件等内容输入类型。 |

<Code lang="typescript" code={promptIdExample} title="带提示词的智能体" />

任何额外的智能体配置（如 tools 或 instructions）会覆盖你在存储的提示词中可能配置的值。

---

## 自定义模型提供方

实现你自己的提供方很简单——实现 `ModelProvider` 和 `Model`，并将该提供方传入 `Runner` 构造函数：

<Code
  lang="typescript"
  code={modelCustomProviderExample}
  title="最简自定义提供方"
/>

如果你想要针对非 OpenAI 模型的现成适配器，请参阅[使用 AI SDK 指定任意模型](/openai-agents-js/zh/extensions/ai-sdk)。

---

## 追踪导出器

使用 OpenAI 提供方时，你可以通过提供 API 密钥选择启用自动追踪导出：

<Code
  lang="typescript"
  code={setTracingExportApiKeyExample}
  title="追踪导出器"
/>

这会将追踪发送到 [OpenAI dashboard](https://platform.openai.com/traces)，你可以在其中检查工作流的完整执行图。

---

## 后续步骤

- 探索[运行智能体](/openai-agents-js/zh/guides/running-agents)。
- 使用[工具](/openai-agents-js/zh/guides/tools)为你的模型赋能。
- 按需添加[护栏](/openai-agents-js/zh/guides/guardrails)或[追踪](/openai-agents-js/zh/guides/tracing)。
