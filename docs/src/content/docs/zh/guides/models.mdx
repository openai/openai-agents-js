---
title: 模型
description: Choose and configure language models for your agents
---

import { Code } from '@astrojs/starlight/components';
import modelCustomProviderExample from '../../../../../../examples/docs/models/customProviders.ts?raw';
import setDefaultOpenAIKeyExample from '../../../../../../examples/docs/config/setDefaultOpenAIKey.ts?raw';
import modelSettingsExample from '../../../../../../examples/docs/models/modelSettings.ts?raw';
import promptIdExample from '../../../../../../examples/basic/prompt-id.ts?raw';
import agentWithModelExample from '../../../../../../examples/docs/models/agentWithModel.ts?raw';
import runnerWithModelExample from '../../../../../../examples/docs/models/runnerWithModel.ts?raw';
import setTracingExportApiKeyExample from '../../../../../../examples/docs/config/setTracingExportApiKey.ts?raw';

每个智能体最终都会调用一个 LLM。SDK 在两个轻量接口后面抽象了模型：

- [`Model`](/openai-agents-js/openai/agents/interfaces/model) —— 知道如何针对某个特定 API 发起一次请求。
- [`ModelProvider`](/openai-agents-js/openai/agents/interfaces/modelprovider) —— 将人类可读的模型**名称**（例如 `'gpt‑4o'`）解析为 `Model` 实例。

在日常使用中，您通常只与模型**名称**交互，偶尔会使用 `ModelSettings`。

<Code
  lang="typescript"
  code={agentWithModelExample}
  title="为每个智能体指定模型"
/>

## 默认模型

当初始化 `Agent` 时未指定模型，将使用默认模型。当前的默认模型是 [`gpt-4.1`](https://platform.openai.com/docs/models/gpt-4.1)，它在智能体工作流的可预测性与低延迟之间提供了良好平衡。

如果您想切换到其他模型，比如 [`gpt-5`](https://platform.openai.com/docs/models/gpt-5)，有两种方式可以为智能体进行配置。

首先，如果您希望对未设置自定义模型的所有智能体一致地使用某个特定模型，请在运行智能体前设置 `OPENAI_DEFAULT_MODEL` 环境变量。

```bash
export OPENAI_DEFAULT_MODEL=gpt-5
node my-awesome-agent.js
```

其次，您可以为某个 `Runner` 实例设置默认模型。如果未为某个智能体设置模型，将使用该 `Runner` 的默认模型。

<Code
  lang="typescript"
  code={runnerWithModelExample}
  title="为 Runner 设置默认模型"
/>

### GPT-5 模型

当您以这种方式使用任一 GPT-5 推理模型（[`gpt-5`](https://platform.openai.com/docs/models/gpt-5)、[`gpt-5-mini`](https://platform.openai.com/docs/models/gpt-5-mini) 或 [`gpt-5-nano`](https://platform.openai.com/docs/models/gpt-5-nano)）时，SDK 会默认应用合理的 `modelSettings`。具体来说，它会将 `reasoning.effort` 与 `verbosity` 都设为 `"low"`。若要为默认模型调整推理强度，请传入您自己的 `modelSettings`：

```ts
import { Agent } from '@openai/agents';

const myAgent = new Agent({
  name: 'My Agent',
  instructions: "You're a helpful agent.",
  modelSettings: {
    providerData: {
      reasoning: { effort: 'minimal' },
      text: { verbosity: 'low' },
    },
  // If OPENAI_DEFAULT_MODEL=gpt-5 is set, passing only modelSettings works.
  // It's also fine to pass a GPT-5 model name explicitly:
  // model: 'gpt-5',
});
```

为了降低延迟，使用 [`gpt-5-mini`](https://platform.openai.com/docs/models/gpt-5-mini) 或 [`gpt-5-nano`](https://platform.openai.com/docs/models/gpt-5-nano) 并设置 `reasoning.effort="minimal"` 通常会比默认设置更快地返回响应。但需要注意，Responses API 中的一些内置工具（例如文件搜索与图像生成）不支持 `"minimal"` 推理强度，因此本 Agents SDK 默认使用 `"low"`。

### 非 GPT-5 模型

如果您传入非 GPT-5 的模型名称且未提供自定义 `modelSettings`，SDK 会回退到适用于任何模型的通用 `modelSettings`。

---

## OpenAI 提供方

默认的 `ModelProvider` 会使用 OpenAI API 来解析名称。它支持两个不同的端点：

| API              | 用途                                             | 调用 `setOpenAIAPI()`               |
| ---------------- | ------------------------------------------------ | ----------------------------------- |
| Chat Completions | 标准聊天与函数调用                               | `setOpenAIAPI('chat_completions')`  |
| Responses        | 新的以流式为先的生成式 API（工具调用、灵活输出） | `setOpenAIAPI('responses')`（默认） |

### 认证

<Code
  lang="typescript"
  code={setDefaultOpenAIKeyExample}
  title="设置默认 OpenAI 密钥"
/>

如果您需要自定义网络设置，也可以通过 `setDefaultOpenAIClient(client)` 接入您自己的 `OpenAI` 客户端。

---

## ModelSettings

`ModelSettings` 与 OpenAI 的参数保持一致，但与提供方无关。

| 字段                | 类型                                       | 说明                                                                      |
| ------------------- | ------------------------------------------ | ------------------------------------------------------------------------- |
| `temperature`       | `number`                                   | 创造性与确定性之间的权衡。                                                |
| `topP`              | `number`                                   | 核采样。                                                                  |
| `frequencyPenalty`  | `number`                                   | 惩罚重复的 token。                                                        |
| `presencePenalty`   | `number`                                   | 鼓励引入新 token。                                                        |
| `toolChoice`        | `'auto' \| 'required' \| 'none' \| string` | 参见[强制使用工具](/openai-agents-js/zh/guides/agents#forcing-tool-use)。 |
| `parallelToolCalls` | `boolean`                                  | 在支持的情况下允许并行函数调用。                                          |
| `truncation`        | `'auto' \| 'disabled'`                     | Token 截断策略。                                                          |
| `maxTokens`         | `number`                                   | 响应中的最大 token 数。                                                   |
| `store`             | `boolean`                                  | 将响应持久化以用于检索/RAG 工作流。                                       |
| `reasoning.effort`  | `'minimal' \| 'low' \| 'medium' \| 'high'` | 适用于 gpt-5 等的推理强度。                                               |
| `text.verbosity`    | `'low' \| 'medium' \| 'high'`              | 适用于 gpt-5 等的文本详尽度。                                             |

可在任一层级附加设置：

<Code lang="typescript" code={modelSettingsExample} title="模型设置" />

`Runner` 层级的设置会覆盖任意相冲突的每个智能体层级设置。

---

## Prompt

可以通过 `prompt` 参数为智能体进行配置，指示应使用一个存储在服务器上的提示配置来控制智能体的行为。目前，只有在使用 OpenAI 的
[Responses API](https://platform.openai.com/docs/api-reference/responses) 时支持此选项。

| 字段        | 类型     | 说明                                                                           |
| ----------- | -------- | ------------------------------------------------------------------------------ |
| `promptId`  | `string` | 提示的唯一标识符。                                                             |
| `version`   | `string` | 要使用的提示版本。                                                             |
| `variables` | `object` | 要替换到提示中的变量键值对。值可以是字符串，或文本、图像、文件等内容输入类型。 |

<Code lang="typescript" code={promptIdExample} title="带有 Prompt 的智能体" />

任意额外的智能体配置，如 tools 或 instructions，将会覆盖您在已存储的提示中可能配置的值。

---

## 自定义模型提供方

实现您自己的提供方很简单——实现 `ModelProvider` 与 `Model`，然后将该提供方传给 `Runner` 构造函数：

<Code
  lang="typescript"
  code={modelCustomProviderExample}
  title="最简自定义提供方"
/>

---

## 追踪导出器

使用 OpenAI 提供方时，您可以通过提供 API 密钥来选择启用自动追踪导出：

<Code
  lang="typescript"
  code={setTracingExportApiKeyExample}
  title="追踪导出器"
/>

这会将追踪发送到 [OpenAI dashboard](https://platform.openai.com/traces)，您可以在其中检查工作流的完整执行图。

---

## 后续步骤

- 探索[运行智能体](/openai-agents-js/zh/guides/running-agents)。
- 通过[工具](/openai-agents-js/zh/guides/tools)为模型赋予强大能力。
- 按需添加[护栏](/openai-agents-js/zh/guides/guardrails)或[追踪](/openai-agents-js/zh/guides/tracing)。
